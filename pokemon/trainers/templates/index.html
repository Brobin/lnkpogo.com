{% extends "base.html" %}

{% load staticfiles humanize pokemon %}

{% block title %}Lincoln Pokemon Stats{% endblock %}

{% block content %}
<h1>Pokemon GO Stats</h1>

<hr/>

<div class="row">
  <div class="col-md-4 col-sm-6">
    <div class="well">
      <div class="text-center">
        <h5>Experience</h5>
        <h1>{{ stats.sum_xp | intword2 }}</h1>
        <p>{{ stats.avg_xp|floatformat:0 | intcomma }} Average</p>
      </div>
      <table class="table table-hover" style="text-align:none">
        <tbody>
          {% for trainer in xp_leaders %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td><img src="{% if trainer.team == 1 %}{% static 'img/mystic.png' %}{% elif trainer.team == 2 %}{% static 'img/valor.png' %}{% else %}{% static 'img/instinct.png' %}{% endif %}" height="30"/> <a href="{% url 'trainer-detail' username=trainer.username %}">&nbsp;{{ trainer.username }}</a></td>
            <td>{{ trainer.xp | intcomma }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <a href="{% url 'trainers' %}" class="text-center">Full Leaderboard...</a>
      <h3 class="text-center">Team Totals</h3>
      <canvas id="xp-chart" height="300"></canvas>
    </div>
  </div>
  <div class="col-md-4 col-sm-6">
    <div class="well">
      <div class="text-center">
        <h5>Pokedex Entries</h5>
        <h1>{{ stats.avg_pokedex_number|floatformat:0 }} Average</h1>
        <p>&nbsp;</p>
      </div>
      <table class="table table-hover" style="text-align:none">
        <tbody>
          {% for trainer in pokedex_leaders %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td><img src="{% if trainer.team == 1 %}{% static 'img/mystic.png' %}{% elif trainer.team == 2 %}{% static 'img/valor.png' %}{% else %}{% static 'img/instinct.png' %}{% endif %}" height="30"/> <a href="{% url 'trainer-detail' username=trainer.username %}">&nbsp;{{ trainer.username }}</a></td>
            <td>{{ trainer.pokedex_number }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <a href="{% url 'trainers' %}?ordering=-pokedex_number" class="text-center">Full Leaderboard...</a>
      <h3 class="text-center">Players per Team</h3>
      <canvas id="players-chart" height="300"></canvas>
    </div>
  </div>
  <div class="col-md-4 col-sm-6">
    <div class="well">
      <div class="text-center">
        <h5>Pokemon Caught</h5>
        <h1>{{ stats.sum_pokemon_caught | intword2 }}</h1>
        <p>{{ stats.avg_pokemon_caught|floatformat:0 | intcomma }} Averafge</p>
      </div>
      <table class="table table-hover" style="text-align:none">
        <tbody>
          {% for trainer in catch_leaders %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td><img src="{% if trainer.team == 1 %}{% static 'img/mystic.png' %}{% elif trainer.team == 2 %}{% static 'img/valor.png' %}{% else %}{% static 'img/instinct.png' %}{% endif %}" height="30"/> <a href="{% url 'trainer-detail' username=trainer.username %}">&nbsp;{{ trainer.username }}</a></td>
            <td>{{ trainer.pokemon_caught | intcomma }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <a href="{% url 'trainers' %}?ordering=-pokemon_caught" class="text-center">Full Leaderboard...</a>
      <h3 class="text-center">Team Totals</h3>
      <canvas id="pokemon-chart" height="300"></canvas>
    </div>
  </div>
  <div class="col-md-4 col-sm-6">
    <div class="well">
      <div class="text-center">
        <h5>Pokestops Spun</h5>
        <h1>{{ stats.sum_pokestops_spun | intword2 }}</h1>
        <p>{{ stats.avg_pokestops_spun|floatformat:0 | intcomma }} Average</p>
      </div>
      <table class="table table-hover" style="text-align:none">
        <tbody>
          {% for trainer in spin_leaders %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td><img src="{% if trainer.team == 1 %}{% static 'img/mystic.png' %}{% elif trainer.team == 2 %}{% static 'img/valor.png' %}{% else %}{% static 'img/instinct.png' %}{% endif %}" height="30"/> <a href="{% url 'trainer-detail' username=trainer.username %}">&nbsp;{{ trainer.username }}</a></td>
            <td>{{ trainer.pokestops_spun | intcomma }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <a href="{% url 'trainers' %}?ordering=-pokestops_spun" class="text-center">Full Leaderboard...</a>
      <h3 class="text-center">Team Totals</h3>
      <canvas id="pokestops-chart" height="300"></canvas>
    </div>
  </div>
  <div class="col-md-4 col-sm-6">
    <div class="well">
      <div class="text-center">
        <h5>Kilometers Walked</h5>
        <h1>{{ stats.sum_kilometers_walked|floatformat:1 | intcomma }}</h1>
        <p>{{ stats.avg_kilometers_walked|floatformat:1 | intcomma }} Average</p>
      </div>
      <table class="table table-hover" style="text-align:none">
        <tbody>
          {% for trainer in walking_leaders %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td><img src="{% if trainer.team == 1 %}{% static 'img/mystic.png' %}{% elif trainer.team == 2 %}{% static 'img/valor.png' %}{% else %}{% static 'img/instinct.png' %}{% endif %}" height="30"/> <a href="{% url 'trainer-detail' username=trainer.username %}">&nbsp;{{ trainer.username }}</a></td>
            <td>{{ trainer.kilometers_walked | intcomma }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <a href="{% url 'trainers' %}?ordering=-kilometers_walked" class="text-center">Full Leaderboard...</a>
      <h3 class="text-center">Team Totals</h3>
      <canvas id="kilometers-chart" height="300"></canvas>
    </div>
  </div>
  <div class="col-md-4 col-sm-6">
    <div class="well">
      <div class="text-center">
        <h5>Battles Won</h5>
        <h1>{{ stats.sum_battles_won | intcomma }}</h1>
        <p>{{ stats.avg_battles_won|floatformat:0 | intcomma }} Average</p>
      </div>
      <table class="table table-hover" style="text-align:none">
        <tbody>
          {% for trainer in battle_leaders %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td><img src="{% if trainer.team == 1 %}{% static 'img/mystic.png' %}{% elif trainer.team == 2 %}{% static 'img/valor.png' %}{% else %}{% static 'img/instinct.png' %}{% endif %}" height="30"/> <a href="{% url 'trainer-detail' username=trainer.username %}">&nbsp;{{ trainer.username }}</a></td>
            <td>{{ trainer.battles_won | intcomma }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <a href="{% url 'trainers' %}?ordering=-battles_won" class="text-center">Full Leaderboard...</a>
      <h3 class="text-center">Team Totals</h3>
      <canvas id="battles-chart" height="300"></canvas>
    </div>
  </div>
</div>
</div>
{% endblock %}

{% block scripts %}
<script>
$(document).ready(function(){
  var pokemonChart = new Chart($("#players-chart"), {
    type: 'doughnut',
    data: {{ charts.players | safe }},
    options: {
      responsive: true
    }
  });
  var pokemonChart = new Chart($("#xp-chart"), {
    type: 'doughnut',
    data: {{ charts.team_xp | safe }},
    options: {
      responsive: true
    }
  });
  var pokemonChart = new Chart($("#pokemon-chart"), {
    type: 'doughnut',
    data: {{ charts.team_pokemon | safe }},
    options: {
      responsive: true
    }
  });
  var pokemonChart = new Chart($("#pokestops-chart"), {
    type: 'doughnut',
    data: {{ charts.team_pokestops | safe }},
    options: {
      responsive: true
    }
  });
  var pokemonChart = new Chart($("#kilometers-chart"), {
    type: 'doughnut',
    data: {{ charts.team_kilometers | safe }},
    options: {
      responsive: true
    }
  });
  var pokemonChart = new Chart($("#battles-chart"), {
    type: 'doughnut',
    data: {{ charts.team_battles | safe }},
    options: {
      responsive: true
    }
  });
});
</script>
{% endblock %}
